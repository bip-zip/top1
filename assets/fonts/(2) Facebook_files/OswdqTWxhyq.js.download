if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }/*FB_PKG_DELIM*/

__d("LSDatabase",[],(function(a,b,c,d,e,f){}),null);
__d("LSTableDefaults",[],(function(a,b,c,d,e,f){e.exports={sync_groups:{syncStatus:[0,0],sendSyncParams:!1,minTimeToSyncTimestampMs:[0,0],canIgnoreTimestamp:!1,priority:[0,0],lastSyncRequestTimestampMs:[0,0],lastSyncCompletedTimestampMs:[0,0],syncChannel:[0,1]},pending_tasks:{enqueueTimestampMs:[0,0],firstExecutedTimestampMs:[0,0],failureCount:[0,0],minTimeToSyncTimestampMs:[0,0],pluginType:[0,0],priority:[0,0]},pending_fire_and_forget_tasks:{enqueueTimestampMs:[0,0],priority:[0,0]},contacts:{isMessengerUser:!1,isMemorialized:!1,blockedByViewerStatus:[0,0],rank:[0,0],contactType:[0,0],contactTypeExact:[0,0],canViewerMessage:!0,gender:[0,0],authorityLevel:[0,0],optimisticBlockedByViewerStatus:[0,0],optimisticBlockedByViewerStatusTimestampMs:[0,0],contactReachabilityStatusType:[0,0],restrictionType:[0,0],waConnectStatus:[0,0],capabilities2:[0,0]},ig_contact_info:{e2eeEligibility:[0,0]},reactions:{timestampMs:[0,0],authorityLevel:[0,0]},threads:{lastActivityTimestampMs:[0,0],lastReadWatermarkTimestampMs:[0,0],removeWatermarkTimestampMs:[0,0],muteExpireTimeMs:[0,0],isAdminSnippet:!1,ongoingCallState:[0,0],snippetHasEmoji:!1,hasPersistentMenu:!1,disableComposerInput:!1,capabilities:[0,0],isCustomThreadPicture:!1,isDisappearingMode:!1,unreadDisappearingMessageCount:[0,0],authorityLevel:[0,0],capabilities2:[0,0],muteCallsExpireTimeMs:[0,0],unsendLimitMs:[0,0],threadInvitesEnabled:[0,0],threadInvitesEnabledV2:[0,0],capabilities3:[0,0]},threads_ranges_v2__generated:{minThreadKey:[0,0],minLastActivityTimestampMs:[0,0],maxThreadKey:[0,0],maxLastActivityTimestampMs:[0,0],isLoadingBefore:!1,isLoadingAfter:!1,hasMoreBefore:!1,hasMoreAfter:!1},messages:{timestampMs:[0,0],primarySortKey:[0,0],secondarySortKey:[0,0],isAdminMessage:!1,sendStatus:[0,0],sendStatusV2:[0,0],isUnsent:!1,replyStatus:[0,0],replyAttachmentType:[0,0],hasQuickReplies:!1,textHasLinks:!1,viewFlags:[0,0],displayedContentTypes:[0,1],quickReplyType:[0,0],authorityLevel:[0,0],unsentTimestampMs:[0,0]},messages_ranges_v2__generated:{isLoadingBefore:!1,isLoadingAfter:!1,hasMoreBefore:!1,hasMoreAfter:!1},participants:{readWatermarkTimestampMs:[0,0],deliveredWatermarkTimestampMs:[0,0],authorityLevel:[0,0],readActionTimestampMs:[0,0],groupParticipantJoinState:[0,0]},attachments:{timestampMs:[0,0],attachmentType:[0,0],hasMedia:!1,isSharable:!1,hasXma:!1,attachmentIndex:[0,0],authorityLevel:[0,0]},attachments_ranges_v2__generated:{mediaGroup:[0,0],isLoadingBefore:!1,isLoadingAfter:!1,hasMoreBefore:!1,hasMoreAfter:!1},attachment_items:{attachmentIndex:[0,0]},group_membership_approval_requests:{authorityLevel:[0,0]},admin_message_ctas:{timestampMs:[0,0],showAdChoiceIcon:!1},thread_nullstate:{ctaType:[0,0],privacyTextCtaType:[0,0]},messages_status:{timestampMs:[0,0]},polls:{pollType:[0,0]},poll_options_v2:{voteCount:[0,0],sortKeyVotingTimestamp:[0,0],sortKeyCreationTimestamp:[0,0]},filtered_threads_ranges_v2__generated:{minThreadKey:[0,0],minLastActivityTimestampMs:[0,0],maxThreadKey:[0,0],maxLastActivityTimestampMs:[0,0],isLoadingBefore:!1,isLoadingAfter:!1,hasMoreBefore:!1,hasMoreAfter:!1,folderName:"inbox",secondaryThreadRangeFilter:[0,0]},community_folders:{capabilities:[0,0],notificationMutedUntil:[0,0]},community_members:{source:[0,0],adminActions:[0,0]},inbox_threads_ranges:{minThreadKey:[0,0],minLastActivityTimestampMs:[0,0],isLoadingBefore:!1,hasMoreBefore:!1},community_direct_invites_presets:{fallbackUrl:"",pictureUrlExpirationTimestampMs1:[0,0],pictureUrlExpirationTimestampMs2:[0,0],presetTypeV2:"ALL_MEMBERS"},sync_group_threads_ranges:{minThreadKey:[0,0],minLastActivityTimestampMs:[0,0],isLoadingBefore:!1,hasMoreBefore:!1},universal_search_recent_searches:{lastAccessedTimestampMs:[0,0]},contact_upload_settings:{authorityLevel:[0,0]},presence_settings:{isActiveStatusViewable:!1,isActiveStatusViewableOnFb:!1,isActiveStatusViewableOnMessenger:!1,hasConvertedToViewSideSettings:!1},video_chat_links_joining:{canAnonymousUsersJoin:[0,0]},notification_settings:{includeInSwitchAccountBadges:!1,mutePageAccountMessageReminder:!1},avatar_settings:{enableAvatarHotlike:!1},transaction_history:{timestampMs:[0,0]},thread_themes:{isDeprecated:!1},ranking_scores:{score:[0,0],scoreIndex:[0,0]},story_buckets:{pageNum:[0,0],readState:[0,0]},stories:{authorityLevel:[0,0]},story_viewers:{interactionType:[0,1],authorityLevel:[0,0]},story_reactions:{authorityLevel:[0,0]},story_ad_unit:{shouldShowAdChoice:!1},story_overlays:{authorityLevel:[0,0]},rooms:{notificationMutedUntilMs:[0,0]},media_staging:{progress:[0,0]},data_trace_meta:{initTimestampMs:[0,0],foregroundTimestampMs:[0,0],traceType:[0,0],shouldFlush:!1},data_trace_addon:{timestampMs:[0,0]},secure_encrypted_backups_client_state:{authorityLevel:[0,0],encryptionVersion:[0,0],revisionVersion:[0,0]},secure_encrypted_backups_epochs:{authorityLevel:[0,0]},encrypted_backups:{authorityLevel:[0,0]},secure_encrypted_backups_generated_recovery_code:{virtualDeviceType:[0,1]},encrypted_backups_virtual_devices:{virtualDeviceType:[0,1],removalStatus:[0,1]},encrypted_backups_metadata:{authorityLevel:[0,0]},cutover_threads:{isMigrated:!1,showOpenMessageHistory:!1}}}),null);
__d("LSStorage",["unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,d,e){a=a.tableNames[b];b=a.indexes;a=a.primaryKeyIds;a=e==null?a:b[e];return a.reduceRight(function(a,b){if(d[b]!==void 0||e!=null)return{hd:d[b],tl:a};throw c("unrecoverableViolation")("primary key must be defined on object","messenger_web_product")},0)}function b(a,b){while(a!==0&&b!==0){if(a.hd!==b.hd&&!(Array.isArray(a.hd)&&Array.isArray(b.hd)&&a.hd.length===b.hd.length&&a.hd.every(function(a,c){return a===b.hd[c]})))return!1;a=a.tl;b=b.tl}return a===0&&b===0}g.searchKey=a;g.areKeysEqual=b}),98);
__d("ReStoreUtils",["LSTableDefaults"],(function(a,b,c,d,e,f,g){"use strict";async function h(j){var k=[],l=await j.next();while(!l.done)k.push(l.value),l=await j.next();return k}function i(j,k){var l=c("LSTableDefaults")[k];return!l?j:Object.keys(l).reduce(function(m,n){Object.prototype.hasOwnProperty.call(m,n)||(m[n]=l[n]);return m},babelHelpers.extends({},j))}g.collectIterator=h;g.appendDefaultValues=i}),98);
__d("ReStoreDefaultValueMigration",["LSTableDefaults","QuickPerformanceLogger","ReStoreDefaultValuesMetadata","ReStoreUtils","nativePromiseRegeneratorRuntime","qpl"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;return c("nativePromiseRegeneratorRuntime").async(function(x){while(1)switch(x.prev=x.next){case 0:f={};x.next=3;return c("nativePromiseRegeneratorRuntime").awrap(d("ReStoreUtils").collectIterator(e.entries(b,a,d("ReStoreDefaultValuesMetadata").defaultValuesTableName,void 0,"asc",void 0)));case 3:g=x.sent,(h=g,i=Array.isArray(h),j=0,h=i?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 5:if(!i){x.next=11;break}if(!(j>=h.length)){x.next=8;break}return x.abrupt("break",41);case 8:k=h[j++];x.next=15;break;case 11:j=h.next();if(!j.done){x.next=14;break}return x.abrupt("break",41);case 14:k=j.value;case 15:l=k;m=l[0];n=l[1];if(!(m!=null)){x.next=39;break}p=d("ReStoreDefaultValuesMetadata").tryParseDefaultValuesData(n);if(!(p==null)){x.next=22;break}return x.abrupt("continue",39);case 22:(q=p.columns,r=p.tableName),f[r]=(o=f[r])!=null?o:new Set(),(s=q,t=Array.isArray(s),u=0,s=t?s:s[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 25:if(!t){x.next=31;break}if(!(u>=s.length)){x.next=28;break}return x.abrupt("break",39);case 28:v=s[u++];x.next=35;break;case 31:u=s.next();if(!u.done){x.next=34;break}return x.abrupt("break",39);case 34:v=u.value;case 35:w=v,f[r].add(w);case 37:x.next=25;break;case 39:x.next=5;break;case 41:return x.abrupt("return",f);case 42:case"end":return x.stop()}},null,this)}function i(a,b,d,e){var f,g,i,j,k,l,m,n;return c("nativePromiseRegeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:o.next=2;return c("nativePromiseRegeneratorRuntime").awrap(h(a,b,d));case 2:f=o.sent;g={};for(i in e.tableNames){j=c("LSTableDefaults")[i];if(j!=null)for(k in j)m=(l=f[i])==null?void 0:l.has(k),m||(g[i]=(n=g[i])!=null?n:{},g[i][k]=j[k])}return o.abrupt("return",g);case 6:case"end":return o.stop()}},null,this)}function j(a,b,e,f){var g,h,i;return c("nativePromiseRegeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:j.t0=c("nativePromiseRegeneratorRuntime").keys(f);case 1:if((j.t1=j.t0()).done){j.next=9;break}g=j.t1.value;h=Object.keys(c("LSTableDefaults")[g]||{});i={columns:h,tableName:g};j.next=7;return c("nativePromiseRegeneratorRuntime").awrap(e.put(b,a,d("ReStoreDefaultValuesMetadata").defaultValuesTableName,d("ReStoreDefaultValuesMetadata").defaultValuesColumnToValue(i)));case 7:j.next=1;break;case 9:case"end":return j.stop()}},null,this)}function a(a,b,e){var f=new WeakMap();c("QuickPerformanceLogger").markerPoint(c("qpl")._(25305590,"1127"),"default_values_update_started");var g=function(a,b){c("QuickPerformanceLogger").markerPoint(c("qpl")._(25305590,"1127"),"default_values_update_end_failure"),c("QuickPerformanceLogger").markerAnnotate(c("qpl")._(25305590,"1127"),{string:{default_values_update_failure_point:b,default_values_update_failure_reason:String(a)}})};return i(f,a,e,b).then(function(b){var g,h,i,k,l;return c("nativePromiseRegeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:m.t0=c("nativePromiseRegeneratorRuntime").keys(b);case 1:if((m.t1=m.t0()).done){m.next=19;break}g=m.t1.value;h=e.entries(a,f,g,void 0,"asc",void 0);m.next=6;return c("nativePromiseRegeneratorRuntime").awrap(h.next());case 6:i=m.sent;case 7:if(i.done){m.next=17;break}k=babelHelpers["extends"]({},i.value[1]);l=d("ReStoreUtils").appendDefaultValues(k,g);m.next=12;return c("nativePromiseRegeneratorRuntime").awrap(e.put(a,f,g,l));case 12:m.next=14;return c("nativePromiseRegeneratorRuntime").awrap(h.next());case 14:i=m.sent;m.next=7;break;case 17:m.next=1;break;case 19:m.next=21;return c("nativePromiseRegeneratorRuntime").awrap(j(f,a,e,b));case 21:c("QuickPerformanceLogger").markerPoint(c("qpl")._(25305590,"1127"),"default_values_update_end_success");case 22:case"end":return m.stop()}},null,this)},function(a){return g(a,"findDefaultValuesToUpdate")})["catch"](function(a){return g(a,"setDefaultValues")})}g.runMigrationForTableDefaultValuesIfNeeded=a}),98);
__d("ReStoreIndicesMigration",["QuickPerformanceLogger","ReStoreIndexMetadata","ReStoreUtils","nativePromiseRegeneratorRuntime","qpl"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,e){var f,g,h,i,j,k,l,m,n,o,p,q,r;return c("nativePromiseRegeneratorRuntime").async(function(s){while(1)switch(s.prev=s.next){case 0:f={};s.next=3;return c("nativePromiseRegeneratorRuntime").awrap(d("ReStoreUtils").collectIterator(e.entries(b,a,d("ReStoreIndexMetadata").indicesTableName,void 0,"asc",void 0)));case 3:g=s.sent,(h=g,i=Array.isArray(h),j=0,h=i?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 5:if(!i){s.next=11;break}if(!(j>=h.length)){s.next=8;break}return s.abrupt("break",27);case 8:k=h[j++];s.next=15;break;case 11:j=h.next();if(!j.done){s.next=14;break}return s.abrupt("break",27);case 14:k=j.value;case 15:l=k;m=l[0];n=l[1];if(!(m!=null)){s.next=25;break}p=d("ReStoreIndexMetadata").tryParseIndexData(n);if(!(p==null)){s.next=22;break}return s.abrupt("continue",25);case 22:(q=p.indexName,r=p.tableName),f[r]=(o=f[r])!=null?o:{},f[r][q]={index:p.data,key:m};case 25:s.next=5;break;case 27:return s.abrupt("return",f);case 28:case"end":return s.stop()}},null,this)}function i(a,b,e,f){var g,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;return c("nativePromiseRegeneratorRuntime").async(function(z){while(1)switch(z.prev=z.next){case 0:z.next=2;return c("nativePromiseRegeneratorRuntime").awrap(h(a,b,e));case 2:g=z.sent;i={};for(j in f.tableNames){k=f.tableNames[j];for(l in k.indexes)n=k.indexes[l],o=(m=g[j])==null?void 0:m[l],d("ReStoreIndexMetadata").indicesDiffer(o==null?void 0:o.index,n)&&(i[j]=(p=i[j])!=null?p:{},i[j][l]=n)}q={};for(r in g){s=g[r];for(t in s)w=s[t],x=(u=f.tableNames[r])==null?void 0:(v=u.indexes)==null?void 0:v[t],x==null&&(q[r]=(y=q[r])!=null?y:{},q[r][t]=w)}return z.abrupt("return",{toRemove:q,toUpdate:i});case 8:case"end":return z.stop()}},null,this)}function j(a,b,e,f){var g,h,i,j,k;return c("nativePromiseRegeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:l.t0=c("nativePromiseRegeneratorRuntime").keys(f);case 1:if((l.t1=l.t0()).done){l.next=15;break}g=l.t1.value;h=f[g];l.t2=c("nativePromiseRegeneratorRuntime").keys(h);case 5:if((l.t3=l.t2()).done){l.next=13;break}i=l.t3.value;j=h[i];k={data:j,indexName:i,tableName:g};l.next=11;return c("nativePromiseRegeneratorRuntime").awrap(e.put(b,a,d("ReStoreIndexMetadata").indicesTableName,d("ReStoreIndexMetadata").indexDataToValue(k)));case 11:l.next=5;break;case 13:l.next=1;break;case 15:case"end":return l.stop()}},null,this)}function k(a,b,e,f){var g,h,i,j;return c("nativePromiseRegeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:k.t0=c("nativePromiseRegeneratorRuntime").keys(f);case 1:if((k.t1=k.t0()).done){k.next=14;break}g=k.t1.value;h=f[g];k.t2=c("nativePromiseRegeneratorRuntime").keys(h);case 5:if((k.t3=k.t2()).done){k.next=12;break}i=k.t3.value;j=h[i].key;k.next=10;return c("nativePromiseRegeneratorRuntime").awrap(e["delete"](b,a,d("ReStoreIndexMetadata").indicesTableName,j));case 10:k.next=5;break;case 12:k.next=1;break;case 14:case"end":return k.stop()}},null,this)}function a(a,b,d){var e=new WeakMap();c("QuickPerformanceLogger").markerPoint(c("qpl")._(25305590,"1127"),"index_migration_started");var f=function(a,b){c("QuickPerformanceLogger").markerPoint(c("qpl")._(25305590,"1127"),"index_migration_end_failure"),c("QuickPerformanceLogger").markerAnnotate(c("qpl")._(25305590,"1127"),{string:{index_migration_failure_point:b,index_migration_failure_reason:String(a)}})};return i(e,a,d,b).then(function(f){var g,h,i,l,m,n,o,p;return c("nativePromiseRegeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:(g=f.toRemove,h=f.toUpdate),i=Array.from(new Set([].concat(Object.keys(h),Object.keys(g)))),c("QuickPerformanceLogger").markerAnnotate(c("qpl")._(25305590,"1127"),{"int":{index_migration_rebuild_tables_count:i.length},string_array:{index_migration_rebuilt_tables:i}}),l=0;case 4:if(!(l<i.length)){q.next=13;break}m=i[l];if(!(b.tableNames[m]!=null)){q.next=10;break}p=Array.from(new Set([].concat(Object.keys((n=h[m])!=null?n:{}),Object.keys((o=g[m])!=null?o:{}))));q.next=10;return c("nativePromiseRegeneratorRuntime").awrap(d.rebuildIndices(a,e,m,p));case 10:l++;q.next=4;break;case 13:q.next=15;return c("nativePromiseRegeneratorRuntime").awrap(j(e,a,d,h));case 15:q.next=17;return c("nativePromiseRegeneratorRuntime").awrap(k(e,a,d,g));case 17:c("QuickPerformanceLogger").markerPoint(c("qpl")._(25305590,"1127"),"index_migration_end_success");case 18:case"end":return q.stop()}},null,this)},function(a){return f(a,"findIndicesToUpdateOrRemove")})["catch"](function(a){return f(a,"rebuildIndices")})}g.runMigrationForIndicesIfNeeded=a}),98);
__d("ReStoreDBCorruption",["gkx"],(function(a,b,c,d,e,f,g){"use strict";var h="Got unexpected undefined",i="ReStoreDBCorruption";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var d,e=c("gkx")("3174")?"true":"false";e=h+", pdb: "+e+", table: "+b;d=a.call(this,e)||this;d.message=e;d.name=i;d.tableName=b;return d}return b}(babelHelpers.wrapNativeSuper(Error));g.ERROR_NAME=i;g.ReStoreDBCorruption=a}),98);
__d("ReStorePersistence",["PromiseOrValue","ReStoreDBCorruption"],(function(a,b,c,d,e,f,g){"use strict";var h={};function i(l,m,n){return(l.has(m)?l:l.set(m,n())).get(m)}function j(l){if(l==null)return l;var m=Object.getOwnPropertyNames(l),j={},n,o;for(n=0;n<m.length;n++)o=l[m[n]],j[m[n]]=Array.isArray(o)?[].concat(o):o;return j}function k(l){return{clearCache:l.clearCache,close:l.close,createTransaction:function(){var m=new Map();return{flush:async function(){await l.flush(m)},table:function(n){function o(s,t){var u=q.get(t);if(u===h)return void 0;return u!==void 0?u:l.get(s,n,t)}function p(s,t){return d("PromiseOrValue").map(o(s,t),function(u){if(u===void 0)throw new(d("ReStoreDBCorruption").ReStoreDBCorruption)(n);return u})}var q=i(m,n,function(){return new Map()});function r(s,t){return{read:function*(u){var v=o(s,u);return v instanceof window.Promise?yield v:v},readExn:function*(u){var v=p(s,u);return v instanceof window.Promise?yield v:v},readHeader:function*(){var u=o(s,t);return u instanceof window.Promise?yield u:u},remove:function*(u){q.set(u,h)},removeHeader:function*(){q.set(t,h)},write:function*(u,v){q.set(u,v)},writeHeader:function*(u){q.set(t,u)},writeNew:function*(u){var v=d("PromiseOrValue").map(o(s,"nextId"),function(v){v===void 0&&(v=0);q.set("nextId",v+1);q.set(v,u);return v});return v instanceof window.Promise?yield v:v}}}return{getBPlusTreeStore:r,incrementSeed:function(s,t){return d("PromiseOrValue").map(o(s,"seed"),function(u){u===void 0&&(u=0);q.set("seed",Math.max(u,t||0)+1);return t===void 0?u:t})},readData:function*(s,t){var u=o(s,t);return u instanceof window.Promise?yield u:u},readDataExn:function*(s,t){var u=p(s,t);return u instanceof window.Promise?yield u:u},readSeed:function(s){return d("PromiseOrValue").map(o(s,"seed"),function(t){t===void 0&&(t=0);return t})},remove:function(s,t){q.set(t,h)},writeData:function(s,t,u){q.set(t,j(u))},writeNewData:function(s,t){return d("PromiseOrValue").map(o(s,"nextId"),function(u){u===void 0&&(u=0);q.set("nextId",u+1);q.set(u,j(t));return u})}}}}},releaseLockIfNeeded:l.releaseLockIfNeeded,waitForLock:l.waitForLock}}g.sentinelDeleted=h;g.createDbStore=k}),98);
__d("ReStoreTransactionLock",["justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h={chainPromiseOrValue:function(k){return k(h)}},i=function(){function i(l){var m=this;this.waitFor=null;l!=null&&(this.waitFor=l.then(function(n){return m.waitFor=null}))}var k=i.prototype;k.chainPromiseOrValue=function(l){if(this.waitFor!=null)return this.waitFor.then(function(){return l(h)});else return l(h)};return i}(),j=function(){function j(){this.lock=null}var k=j.prototype;k.chainPromiseOrValue=function(l){var m=this;if(!c("justknobx")._("553"))return h.chainPromiseOrValue(l);var n=this.lock;if(n==null){var o=l(h);if(o instanceof window.Promise)n=o;else return o}else n=n.then(function(){return l(h)});var p=n.then(function(q){m.lock===p&&(m.lock=null);return q}).finally(function(q){m.lock===p&&(m.lock=null)});this.lock=p;return p};return j}();g.WaitForPromiseLock=i;g.ReStoreTransactionLock=j}),98);
__d("ReQLBounds.bs",["LSDbKeyComparer.bs","bs_js_dict","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";function g(a,b,c){if(!b)return c;if(a<=0)return c;var d=b.hd;if(a===1)return{hd:d,tl:0};else return{hd:d,tl:g(a-1|0,b.tl,c)}}function a(a,c){return g(a,c,{hd:b("LSDbKeyComparer.bs").maxKey,tl:0})}function c(a,c){a=function(a){var b=a.NAME;if(b==="lessThan")return["lt",a.VAL];else if(b==="greaterThan")return["gt",a.VAL];else if(b==="greaterThanOrEqual")return["gte",a.VAL];else return["lte",a.VAL]};var d=c.NAME;if(d!=="range")if(d==="greaterThanOrEqual"||d==="greaterThan")return b("bs_js_dict").fromArray([a(c)]);else return b("bs_js_dict").fromArray([a(c)]);d=c.VAL;return b("bs_js_dict").fromArray([a(d[0]),a(d[1])])}function d(a){var c=a.operation;switch(c){case"add":return{TAG:0,_0:a.value};case"delete":return 0;case"put":return{TAG:1,_0:a.value};default:return b("unrecoverableViolation")("Unexpected operation","messenger_web_product")}}f.concat=g;f.nextKey=a;f.mapBounds=c;f.mapEventToOperation=d}),null);
__d("IntervalList",["FBLogger","LSDbKeyComparer","ReQLBounds.bs","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a){if(a==null)throw c("FBLogger")("messenger_web_product").mustfixThrow("must not be null");return a}function a(a,c){var e=b("regeneratorRuntime").mark(k),f=new Map(),g=new Map(),i=new Map();function j(b,c){return c==null?!0:(c.gt!==void 0?a(b,c.gt)>0:c.gte!==void 0?a(b,c.gte)>=0:!0)&&(c.lt!==void 0?a(b,c.lt)<0:c.lte!==void 0?a(b,c.lte)<=0:!0)}function k(a){var h,i,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;return b("regeneratorRuntime").wrap(function(b){while(1)switch(b.prev=b.next){case 0:h=a,i={hd:d("LSDbKeyComparer").MAX_KEY,tl:0},k=0;case 3:if(!(h!==0&&g.size)){b.next=33;break}k++;l=h;m=h.tl;h.tl=k<c?i:0;b.prev=8;n=g.get(JSON.stringify(a));if(!(n!=null)){b.next=27;break}o=n,p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();case 12:if(!p){b.next=18;break}if(!(q>=o.length)){b.next=15;break}return b.abrupt("break",27);case 15:r=o[q++];b.next=22;break;case 18:q=o.next();if(!q.done){b.next=21;break}return b.abrupt("break",27);case 21:r=q.value;case 22:s=r;b.next=25;return s;case 25:b.next=12;break;case 27:b.prev=27;l.tl=m;return b.finish(27);case 30:h=l.tl;b.next=3;break;case 33:t=f.entries(),u=Array.isArray(t),v=0,t=u?t:t[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();case 34:if(!u){b.next=40;break}if(!(v>=t.length)){b.next=37;break}return b.abrupt("break",52);case 37:w=t[v++];b.next=44;break;case 40:v=t.next();if(!v.done){b.next=43;break}return b.abrupt("break",52);case 43:w=v.value;case 44:x=w;y=x[0];z=x[1];if(!(f.has(y)&&j(a,z))){b.next=50;break}b.next=50;return y;case 50:b.next=34;break;case 52:case"end":return b.stop()}},e,this,[[8,,27,30]])}function l(a){var b=i.get(a);if(b!=null){i["delete"](a);var c=h(g.get(b));c["delete"](a);c.size===0&&g["delete"](b)}else f["delete"](a)}function m(a,b){var e;if(a&&a.gte!=null&&a.lte!=null&&(e=JSON.stringify(d("ReQLBounds.bs").nextKey(c,a.gte)))===JSON.stringify(a.lte)){var h=g.get(e);h==null&&(h=new Set(),g.set(e,h));h.add(b);i.set(b,e)}else f.set(b,a)}return{"delete":l,findIntersecting:k,set:m}}g["default"]=a}),98);
__d("createReStoreSubscriptionManager",["IntervalList","LSDbKeyComparer","LSStorage","Promise","cr:181","killswitch","nullthrows","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){var f=new Map(),g=new Map();function h(a,c,d,e){return b("Promise").all(Array.from(a.findIntersecting(d)).map(function(a){return a(d,e,c)}))}function i(b){return c("nullthrows")((f.has(b)?f:f.set(b,[c("IntervalList")(d("LSDbKeyComparer").compareKey,a.tableNames[b].primaryKeyIds.length),new Map()])).get(b))}function j(b,e){var f=i(b);f[0];f=f[1];return c("nullthrows")((f.has(e)?f:f.set(e,c("IntervalList")(d("LSDbKeyComparer").compareKey,a.tableNames[b].indexes[e].length))).get(e))}function k(e,f,g,i,j,k){var l=function(a,b){return h(e,k,a,b)},m=g==null?void 0:d("LSStorage").searchKey(a,f,g,j),n=i==null?void 0:d("LSStorage").searchKey(a,f,i,j);if(n==null&&m!=null)return l(m,{operation:"delete",prevValue:g});if(m==null&&n!=null)return l(n,{operation:"add",value:c("nullthrows")(i)});return m!=null&&n!=null?d("LSDbKeyComparer").compareKey(m,n)===0?l(m,{operation:"put",prevValue:g,value:c("nullthrows")(i)}):l(m,{operation:"delete",prevValue:g}).then(function(){return l(n,{operation:"add",value:c("nullthrows")(i)})}):b("Promise").resolve()}function l(a,d,f,g,h){h===void 0&&(h=!1);!c("killswitch")("MESSENGER_WEB_PERSISTED_DB")&&h&&e(a)&&b("cr:181")!=null&&b("cr:181").postMessage("notifyTable",[a,d,f]);h=i(a);var j=h[0],l=h[1];return k(j,a,d,f,null,g).then(function(){return b("Promise").all(Array.from(l.entries()).map(function(b){var c=b[0];b=b[1];return k(b,a,d,f,c,g)}).filter(function(a){return a!=null}))})}function m(a){a===void 0&&(a=!1),!c("killswitch")("MESSENGER_WEB_PERSISTED_DB")&&a&&b("cr:181")!=null&&b("cr:181").postMessage("notifyCommit"),g.forEach(function(a){return a()})}!c("killswitch")("MESSENGER_WEB_PERSISTED_DB")&&b("cr:181")!=null&&(b("cr:181").onEventReceive("notifyTable",function(a){var b=a[0],d=a[1];a=a[2];var e=new WeakMap();c("promiseDone")(l(b,d,a,e,!1))}),b("cr:181").onEventReceive("notifyCommit",function(a){m(!1)}));return{dispose:function(){f.clear(),g.clear()},notifyCommit:m,notifyTableAndIndexSubscribers:l,subscribeIndex:function(a,c,d,e){var f=j(a,c),g=!1,h=function(a,c,e){return g?b("Promise").resolve():d(a,c,e)};f.set(e,h);return function(){g=!0,f["delete"](h)}},subscribeTable:function(a,c,d){a=i(a);var e=a[0],f=!1,g=function(a,d,e){return f?b("Promise").resolve():c(a,d,e)};e.set(d,g);return function(){f=!0,e["delete"](g)}},subscribeToCommit:function(a){g.set(a,a);return function(){g["delete"](a)}}}}g["default"]=a}),98);
__d("ReStore",["BPlusTreeBase","ExecutionEnvironment","FBLogger","I64","LSDbKeyComparer","LSStorage","PromiseOrValue","ReStoreDefaultValueMigration","ReStoreIndicesMigration","ReStorePersistence","ReStoreTransactionLock","ReStoreUtils","clearTimeout","createReStoreSubscriptionManager","err","gkx","justknobx","setTimeout","unrecoverableViolation"],(function(aa,ba,a,b,ca,da,ea){"use strict";var fa=new Set(["threads","messages","pending_tasks","network_requests"]),ga=function(e){babelHelpers.inheritsLoose(ga,e);function ga(){return e.call(this,"Transaction has finished")||this}return ga}(babelHelpers.wrapNativeSuper(Error));function ha(e){var f=b("I64").cast(e);if(f===void 0)throw a("unrecoverableViolation")("Expected int64","messenger_web_product");return b("I64").to_float(f)}function c(e,f){function g(h){if(h.done)return h.value;if(!(h.value instanceof Promise))throw a("unrecoverableViolation")("expected promise","messenger_web_product");return h.value.then(function(i){return g(e.next(i))})}return g(e.next(f))}function ia(e,f){return!a("justknobx")._("553")?e:{next:function(g){return f.chainPromiseOrValue(function(){return e.next(g)})}}}function ja(e,f){if(!a("justknobx")._("553"))return f;var g=babelHelpers.extends({},f),h=function(i){g[i]=function(){for(var j=arguments.length,k=new Array(j),l=0;l<j;l++)k[l]=arguments[l];return e.chainPromiseOrValue(function(){return f[i].apply(f,k)})}};for(var i in f)h(i);g.entries=function(j,k,l,m,n,ma){return ia(f.entries(j,k,l,m,n,ma),e)};return g}function d(e,f,g){return a("BPlusTreeBase")(b("LSDbKeyComparer").compareKey,16,f.getBPlusTreeStore(e,g==null?"root":"index("+g+")"))}function ka(e,f,g){return(e.has(f)?e:e.set(f,g())).get(f)}function la(e,f){var g=b("ReStorePersistence").createDbStore(e),h=a("createReStoreSubscriptionManager")(f,e.shouldSync),i=ba("LSStorage").searchKey.bind(null,f),j=Promise.resolve(),k=new Map(),l=null;function m(p,q,r){return!q||p<=0?r:{hd:q.hd,tl:p===1?0:m(p-1,q.tl,r)}}function n(p,q){if(p==null)return void 0;var r=babelHelpers.extends({},p);r.gt!=null&&(r.gt=m(q,r.gt,{hd:b("LSDbKeyComparer").MAX_KEY,tl:0}));r.lte!=null&&(r.lte=m(q,r.lte,{hd:b("LSDbKeyComparer").MAX_KEY,tl:0}));return r}function ma(p,q){return function(r){return{add:async function(s){var t;try{a("gkx")("3827")&&(t=a("setTimeout")(function(){a("FBLogger")("messenger_web_product").mustfix("ReStore add took longer than 10 seconds to execute")},1e4));return await q.add(p,new WeakMap(),r,s)}finally{t!=null&&a("clearTimeout")(t)}},delete:function(s){return q.delete(p,new WeakMap(),r,s)},deleteThenInsert:function(s){return q.deleteThenInsert(p,new WeakMap(),r,s)},entries:function(s,t,u){t===void 0&&(t="asc");return q.entries(p,s,r,void 0,t,u)},get:function(s,t){t===void 0&&(t=new WeakMap());return q.get(p,t,r,void 0,s)},index:function(s){return{entries:function(t,u,v){u===void 0&&(u="asc");return q.entries(p,t,r,s,u,v)},get:function(t){return q.get(p,new WeakMap(),r,s,t)},getKey:function(t){return q.getKey(p,new WeakMap(),r,s,t)},keyLength:f.tableNames[r].indexes[s].length}},keyLength:f.tableNames[r].primaryKeyIds.length,peekNextAutoIncrementId:function(){return q.peekNextAutoIncrementId(p,new WeakMap(),r)},put:function(s){return q.put(p,new WeakMap(),r,s)},upsert:function(s,t){return q.upsert(p,new WeakMap(),r,s,t)}}}}function na(p){function q(D,E,F,G){var H=JSON.stringify([D,E]),I=p.get(H);p.set(H,[I==null?F:I[0],G])}async function r(D,E,F,G,H){var I=D.table(F),J=d(E,I,G),K=await c(J.getWithDefault(H,void 0));return K===void 0?void 0:c(I.readDataExn(E,K))}async function s(D,E,F,G,H){var I=await r(D,E,F,G,H);return I===void 0?void 0:i(F,I)}function t(D,E,F,G,H,I){function J(){var K,L=0,M=D.table(F),N=d(E,M,G),O=N.entries(babelHelpers.extends({},n(I,(G===void 0?f.tableNames[F].primaryKeyIds:f.tableNames[F].indexes[G]).length),{dir:H}));return K={next:function(P){a("gkx")("3827")&&(L++,L===20&&!fa.has(F)&&a("FBLogger")("messenger_web_product").catching(a("err")("ReStore overfetch")).warn('ReStore fetched 20 or more rows from "%s" table',F));return b("PromiseOrValue").map(c(O.next(P)),function(Q){return Q.done?{done:!0}:b("PromiseOrValue").map(c(M.readDataExn(E,Q.value[1])),function(R){return{done:!1,value:[Q.value[0],R]}})})}},K[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]=J,K}return J()}async function u(D,E,F,G,H){function I(S,T){var U=[],V=S;while(V!==0)U.push(V.hd),V=V.tl;return U.length>=T?S:U.reduceRight(function(W,X){return{hd:X,tl:W}},{hd:b("LSDbKeyComparer").MAX_KEY,tl:0})}if(H!=null&&b("LSDbKeyComparer").compareKey(G,H)===0)return;var J=f.tableNames[F],K=J.cascadeUpdates,L=J.primaryKeyIds,M=async function(){if(O){if(P>=N.length)return"break";Q=N[P++]}else{P=N.next();if(P.done)return"break";Q=P.value}var S=Q,T=S.indexName,F=S.tableName,U=f.tableNames[F],V=U.indexes,W=U.primaryKeyIds,X=T==null?W:V[T],ta={gte:G,lte:I(G,X.length)},ua=await b("ReStoreUtils").collectIterator(t(D,E,F,T,"asc",ta));for(var Y=ua,Z=Array.isArray(Y),$=0,Y=Z?Y:Y[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var va;if(Z){if($>=Y.length)break;va=Y[$++]}else{$=Y.next();if($.done)break;va=$.value}var wa=va;wa[0];var xa=wa[1],ya=i(F,xa);if(H===void 0)await y(D,E,F,ya),await u(D,E,F,ya,void 0);else{var za=L.reduce(function(Aa,Ba,Ca){var Da=Aa[0],H=Aa[1];if(!H)return[Da,H];Da[X[Ca]]=H.hd;return[Da,H.tl]},[babelHelpers.extends({},xa),H])[0];await x(D,E,F,ya,za);await u(D,E,F,ya,i(F,za))}}};for(var N=K,O=Array.isArray(N),P=0,N=O?N:N[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var Q,R=await M();if(R==="break")break}}async function v(D,E,F){var G=f.tableNames[F].autoIncrement;if(!G)throw a("unrecoverableViolation")("only supported for auto-incrementing tables","messenger_web_product");var H=await D.table(F).readSeed(E);if(H===void 0)throw a("unrecoverableViolation")("unexpected undefined autoIncrementSeed","messenger_web_product");return b("I64").of_float(H)}async function w(D,E,F,G){F==="messages_optimistic_context"&&typeof G.skipUrlPreviewGen==="object"&&a("FBLogger")("messenger_web_product").mustfix("objects not expected in skipUrlPreviewGen column of messages_optimistic_context");var H=D.table(F),I=d(E,H),J=f.tableNames[F],K=i(F,G),L={},M=await c(I.getWithDefault(K,void 0)),N,O=G;if(M!==void 0)N=await c(H.readDataExn(E,M)),L=z(Object.keys(J.indexes),F,N),H.writeData(E,M,G);else{if(J.autoIncrement)throw a("unrecoverableViolation")("Id must not be specified for new record when table has an autoincrementing primary key","messenger_web_product");O=b("ReStoreUtils").appendDefaultValues(G,J.name);M=await b("PromiseOrValue").map(H.writeNewData(E,O),async function(X){await c(I.set(K,X));return X})}var P=z(Object.keys(J.indexes),F,O),Q=Object.keys(P);for(var R=0;R<Q.length;R++){var S=Q[R];L[S]!==void 0&&b("LSDbKeyComparer").compareKey(L[S],P[S])===0&&(delete P[S],delete L[S])}await A(D,E,F,P);await B(D,E,F,M,P);var T=Object.keys(L);for(var U=0;U<T.length;U++){var V=T[U],W=d(E,H,V);await c(W.delete(L[V]))}q(F,K,N,O)}async function x(D,E,F,G,H){var I=i(F,H);b("LSStorage").areKeysEqual(G,I)||await y(D,E,F,G);await w(D,E,F,H)}async function y(D,E,F,G){var H=D.table(F),I=d(E,H),J=f.tableNames[F],K=await c(I.getWithDefault(G,void 0)),L;if(K!==void 0){L=await c(H.readDataExn(E,K));if(Object.keys(J.indexes).length){var M=Object.keys(J.indexes);for(var N=0;N<M.length;N++){var O=M[N],P=i(F,L,O);if(P!=null){var Q=d(E,H,O);await c(Q.delete(P))}}}return b("PromiseOrValue").map(c(I.delete(G)),function(){H.remove(E,K),q(F,G,L,void 0)})}}function z(D,E,F){return D.reduce(function(G,H){var I=i(E,F,H);G[H]=I;return G},{})}async function A(D,E,F,G){var H=D.table(F),I=new Set(),J=Object.keys(G);for(var K=0;K<J.length;K++){var L=J[K],M=d(E,H,L),N=G[L],O=await c(M.getWithDefault(N));if(O!=null&&!I.has(O)){var P=i(F,await c(H.readDataExn(E,O)));await y(D,E,F,P);await u(D,E,F,P,void 0);I.add(O)}}}async function B(D,E,F,G,H){var I=D.table(F),J=Object.keys(H);for(var K=0;K<J.length;K++){var L=J[K],M=d(E,I,L),N=H[L];await c(M.set(N,G))}}async function C(D,E,F,G){F==="messages_optimistic_context"&&typeof G.skipUrlPreviewGen==="object"&&a("FBLogger")("messenger_web_product").mustfix("objects not expected in skipUrlPreviewGen column of messages_optimistic_context");var H=D.table(F),I=d(E,H),J=f.tableNames[F];if(J.autoIncrement){var K=G[f.tableNames[F].primaryKeyIds[0]],L=b("I64").of_float(await H.incrementSeed(E,K===void 0?K:ha(K)));G[f.tableNames[F].primaryKeyIds[0]]=L}var M=b("ReStoreUtils").appendDefaultValues(G,J.name),N=i(F,M);if(N==null)throw new Error("Evaluating the object store's key path did not yield a value");if(!await c(I.has(N))){var O=z(Object.keys(J.indexes),F,M);await A(D,E,F,O);await b("PromiseOrValue").map(H.writeNewData(E,M),async function(K){await c(I.set(N,K)),await B(D,E,F,K,O)});q(F,N,void 0,M)}}async function sa(D,E,F,G){var H=D.table(F),I=G.map(function(Y){return d(E,H,Y)});for(var J=I,K=Array.isArray(J),L=0,J=K?J:J[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var M;if(K){if(L>=J.length)break;M=J[L++]}else{L=J.next();if(L.done)break;M=L.value}var N=M;await c(N.clear())}var O=G.filter(function(Y){var Z;return((Z=f.tableNames[F])==null?void 0:Z.indexes[Y])!=null});if(O.length===0)return;var P=d(E,H),Q=await b("ReStoreUtils").collectIterator(t(D,E,F,void 0,"asc",void 0));for(var R=Q,S=Array.isArray(R),T=0,R=S?R:R[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var U;if(S){if(T>=R.length)break;U=R[T++]}else{T=R.next();if(T.done)break;U=T.value}var V=U,W=V[0],X=V[1],ta=z(O,F,X);await A(D,E,F,ta);var ua=await c(P.get(W));await B(D,E,F,ua,ta)}}return{add:C,delete:async function(D,E,F,G){await y(D,E,F,G),await u(D,E,F,G,void 0)},deleteThenInsert:async function(D,E,F,G){var H=b("ReStoreUtils").appendDefaultValues(G,F);await w(D,E,F,H);await u(D,E,F,i(F,H),void 0)},entries:t,get:r,getKey:s,peekNextAutoIncrementId:v,put:w,rebuildIndices:sa,upsert:async function(D,E,F,G,H){await x(D,E,F,G,H),await u(D,E,F,G,i(F,H))}}}function oa(p,q){var r=new(b("ReStoreTransactionLock").ReStoreTransactionLock)();return{table:ma(p,ja(new(b("ReStoreTransactionLock").WaitForPromiseLock)(l),ja(r,na(q))))}}async function pa(p,q){var r=g.createTransaction(),s=await p(oa(r,q),r);await r.flush();return s}var o={background:{first:null,last:null},ui:{first:null,last:null}};async function qa(p,q){o[q].last==null?o[q].first=o[q].last={value:p}:o[q].last=o[q].last.next={value:p};try{await g.waitForLock();var r=o.ui.first==null?o.background:o.ui;if(r.first==null){a("FBLogger")("messenger_web_product").mustfix("Expected work is missing");return}var s=r.first;r.first===r.last&&(r.last=null);r.first=r.first.next;await s.value()}finally{await g.releaseLockIfNeeded()}}function ra(p,q,r){r===void 0&&(r="background");var s=new Map(),t;a("gkx")("3827")&&(t=a("err")(""));return new Promise(function(u,v){j=j.then(function(){return qa(async function(){var w;try{a("gkx")("3827")&&b("ExecutionEnvironment").canUseDOM&&(w=a("setTimeout")(function(){a("FBLogger")("messenger_web_product").catching(t).mustfix("ReStore transaction took longer than 10 seconds to execute")},1e4));var x=await pa(function(J,K){return p(J)},s);w!=null&&a("clearTimeout")(w);var y=new WeakMap();for(var z=s,A=Array.isArray(z),B=0,z=A?z:z[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var C;if(A){if(B>=z.length)break;C=z[B++]}else{B=z.next();if(B.done)break;C=B.value}var sa=C,D=sa[0],E=sa[1],F=E[0],G=E[1],H=JSON.parse(D),I=H[0];H[1];await h.notifyTableAndIndexSubscribers(I,F,G,y,!0)}u(x)}catch(J){a("gkx")("3827")&&w!=null&&a("clearTimeout")(w),v(J)}h.notifyCommit(!0)},r)})})}a("gkx")("6477")&&(j=j.then(function(){return qa(function(){var p=new Map();return pa(async function(q,r){await b("ReStoreDefaultValueMigration").runMigrationForTableDefaultValuesIfNeeded(r,f,na(p))},p)},"background")}),l=j);a("gkx")("4547")&&(j=j.then(function(){return qa(async function(){var p=new Map();return pa(async function(q,r){await b("ReStoreIndicesMigration").runMigrationForIndicesIfNeeded(r,f,na(p))},p)},"background")}),l=j);return{clearCacheIfSupported:function(){var p=g;p instanceof Object&&p.clearCache!==void 0&&p.clearCache instanceof Function&&p.clearCache()},closeDb:function(){var p=g;p instanceof Object&&p.close!==void 0&&p.close()},getTableData:function(){return f},runInTransaction:ra,subscribeToCommit:function(p){return h.subscribeToCommit(p)},subscriptionManager:h,table:function(p){return ka(k,p,function(){var q=new Map(),r=ja(new(b("ReStoreTransactionLock").WaitForPromiseLock)(l),na(new Map())),s=r.entries,t=r.get,u=r.getKey,v=r.peekNextAutoIncrementId;return{entries:function(w,x,y){x===void 0&&(x="asc");return ia(s(g.createTransaction(),w,p,void 0,x,y),new(b("ReStoreTransactionLock").ReStoreTransactionLock)())},get:function(w,x){x===void 0&&(x=new WeakMap());return t(g.createTransaction(),x,p,void 0,w)},index:function(w){return ka(q,w,function(){return{entries:function(x,y,z){y===void 0&&(y="asc");return ia(s(g.createTransaction(),x,p,w,y,z),new(b("ReStoreTransactionLock").ReStoreTransactionLock)())},get:function(x,y){y===void 0&&(y=new WeakMap());return t(g.createTransaction(),y,p,w,x)},getKey:function(x){return u(g.createTransaction(),new WeakMap(),p,w,x)},keyLength:f.tableNames[p].indexes[w].length,subscribe:function(x,y){return h.subscribeIndex(p,w,x,n(y,f.tableNames[p].indexes[w]))}}})},keyLength:f.tableNames[p].primaryKeyIds.length,peekNextAutoIncrementId:function(){return v(g.createTransaction(),new WeakMap(),p)},subscribe:function(w,x){return h.subscribeTable(p,w,n(x,f.tableNames[p].primaryKeyIds.length))}}})}}}la.TransactionClosedError=ga;ea.default=la}),98);
__d("createReStoreEphemeralPersistence",["ReStorePersistence","justknobx","nativePromiseRegeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){return(a.has(b)?a:a.set(b,c())).get(b)}function a(){var a=new Map();function b(b){return h(a,b,function(){return new Map()})}return{flush:function(a){return c("nativePromiseRegeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:a.forEach(function(a,e){var f=b(e),g=[];a.forEach(function(a,b){if(c("justknobx")._("579")&&a.isLeaf===!0)for(var e=a.children,h=Array.isArray(e),i=0,e=h?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j;if(h){if(i>=e.length)break;j=e[i++]}else{i=e.next();if(i.done)break;j=i.value}j=j;g.push(j)}a===d("ReStorePersistence").sentinelDeleted?f["delete"](b):f.set(b,a)})});case 1:case"end":return e.stop()}},null,this)},get:function(a,c,d){a=b(c);return a.get(d)},releaseLockIfNeeded:function(){return window.Promise.resolve()},shouldSync:function(){return!1},waitForLock:function(){return window.Promise.resolve()}}}g["default"]=a}),98);
__d("LSJSInMemoryStorage.bs",["ReStore","createReStoreEphemeralPersistence"],(function(a,b,c,d,e,f){"use strict";function a(a){return b("ReStore")(b("createReStoreEphemeralPersistence")(),a)}f.make=a}),null);
__d("LSMailboxInitialSyncCursor",["I64","LSPlatformMessengerSyncParams","LSPlatformWorkplaceSyncParams","gkx","qex"],(function(a,b,c,d,e,f,g){"use strict";a=c("gkx")("1224637")?c("LSPlatformWorkplaceSyncParams").mailbox:c("LSPlatformMessengerSyncParams").mailbox;b=d("I64").of_int32(c("qex")._("461")===!0?3:1);e=d("I64").of_int32(0);g.syncParams=a;g.syncChannel=b;g.lastSyncTimestampMs=e}),98);
__d("LSSyncGroupsUtils",["CurrentLocale","LSIntEnum"],(function(a,b,c,d,e,f,g){"use strict";a={canIgnoreTimestamp:!1,currentCursor:void 0,dataTraceId:void 0,groupId:d("LSIntEnum").ofNumber(0),initTraceTimestampMs:void 0,lastSyncCompletedTimestampMs:void 0,lastSyncRequestTimestampMs:d("LSIntEnum").ofNumber(0),minTimeToSyncTimestampMs:d("LSIntEnum").ofNumber(-1),priority:d("LSIntEnum").ofNumber(0),regionHint:void 0,sendSyncParams:!0,syncChannel:d("LSIntEnum").ofNumber(1),syncParams:JSON.stringify({locale:c("CurrentLocale").get()}),syncStatus:d("LSIntEnum").ofNumber(0)};b={epochId:void 0,failureCount:d("LSIntEnum").ofNumber(0),lastDelayedRequestTimestampMs:void 0,lastSentTimestampMs:d("LSIntEnum").ofNumber(0),lastSyncRequestTimestampMs:d("LSIntEnum").ofNumber(0),networkTaskIdentifier:void 0,syncDatabaseId:d("LSIntEnum").ofNumber(0),taskQueueName:""};e=d("LSIntEnum").ofNumber(0);f=d("LSIntEnum").ofNumber(9999999999999);g.defaultSyncGroup=a;g.defaultNetworkRequest=b;g.initialEpochId=e;g.neverSyncTimestamp=f}),98);
__d("MNetRankType",[],(function(a,b,c,d,e,f){a=Object.freeze({INBOX_ACTIVE_NOW:0,MESSENGER_USER_SEARCH:1,MONTAGE_USER:2,BROADCAST_FLOW_TOP_CONTACTS:3,BROADCAST_FLOW_NEEDY_CONTACTS:4,MESSENGER_GROUP_SEARCH:5,RTC_TOP_CONTACTS:6,PSTN_TOP_CONTACTS:7,MESSENGER_NON_CONTACT_SEARCH:8,MESSENGER_SEARCH_BOOTSTRAP:9,ACTIVE_BEEPER:10,MONTAGE_AND_ACTIVE_NOW:11,MESSENGER_PAGE_SEARCH:12,MESSENGER_GAME_SEARCH:13,WWW_NULLSTATE:14,RTC_GROWTH:15,MESSENGER_OMNIPICKER_NULLSTATE:16,RTC_SEQUENTIAL_TOP_CONTACTS:17,MESSENGER_USER_SEARCH_NULLSTATE:18,MLITE_DIODE_PROMOTION:19,MESSENGER_PENDING_REQUEST:20,MESSENGER_CLOSE_CONNECTION:21,MESSENGER_MONTAGE_SEEN_SHEET:22,MESSENGER_OMNIPICKER_KEYPRESS:23,MESSENGER_NOTIF_QP_TARGETING_UPSELL_TYPE:24,CONTACT_TAB_ACTIVE_NOW:26,MESSENGER_UNIV_NULLSTATE_BLEND:27,MESSENGER_INBOX_THREADS:28,INBOX_ACTIVE_NOW_NO_BOOSTING:29,BROADCAST_FLOW_TOP_CONTACTS_FB_SHARE:30,BROADCAST_FLOW_TOP_CONTACTS_MESSENGER_SHARE:31,BROADCAST_FLOW_TOP_CONTACTS_EXTERNAL_SHARE:32,MESSENGER_TRENDING_STICKERS:33,MESSENGER_BROADCAST_FLOW_TOP_THREADS:34,MESSENGER_SENDS_28D:35,MESSENGER_ROOM_INVITE:36,MESSENGER_ROOM_INVITE_SEARCH:37,INBOX_ACTIVE_NOW_PREFETCH:38,MESSENGER_BLENDED_KEYPRESS:39,MESSENGER_BLENDED_NULLSTATE:40,MESSENGER_CARRIER_MESSAGING:41,MESSENGER_ROOM_INVITE_GROUP:42,MESSENGER_INBOX_BIRTHDAY_ITEM:43,INSTAGRAM_DIRECT_SEARCH_NULLSTATE:44,BROADCAST_FLOW_TOP_CONTACTS_AND_TOP_THREAD_FB_SHARE:45,BROADCAST_FLOW_TOP_THREADS_FB_SHARE:46,FB_H_SCROLL_RANKING:47,FB_MESSAGING_USER_SEARCH:48,FB_MESSAGING_USER_SEARCH_NULLSTATE:49});f["default"]=a}),66);
__d("LSDefaultSyncGroups",["CurrentUser","I64","LSIntEnum","LSMailboxInitialSyncCursor","LSSyncGroupsUtils","MAWGating.re","MNetRankType","Promise","ReQL","gkx","nativePromiseRegeneratorRuntime","qex"],(function(a,b,c,d,e,f,g){"use strict";var h=new Set();d("MAWGating.re").isArmadillo()&&d("MAWGating.re").isOccamadillo()&&h.add(95);e=d("MAWGating.re").isOccamadillo()?{groupId:95}:null;f=[{groupId:1,lastSyncRequestTimestampMs:d("LSMailboxInitialSyncCursor").lastSyncTimestampMs,syncChannel:d("LSMailboxInitialSyncCursor").syncChannel,syncParams:d("LSMailboxInitialSyncCursor").syncParams},{groupId:2,lastSyncRequestTimestampMs:d("LSMailboxInitialSyncCursor").lastSyncTimestampMs,syncChannel:d("LSMailboxInitialSyncCursor").syncChannel},{groupId:7,minTimeToSyncTimestampMs:d("LSSyncGroupsUtils").neverSyncTimestamp,syncParams:JSON.stringify({mnet_rank_types:[c("MNetRankType").MESSENGER_USER_SEARCH,c("MNetRankType").MESSENGER_USER_SEARCH_NULLSTATE,c("MNetRankType").INBOX_ACTIVE_NOW,c("MNetRankType").MESSENGER_OMNIPICKER_NULLSTATE]})},{groupId:15,minTimeToSyncTimestampMs:d("LSSyncGroupsUtils").neverSyncTimestamp},{groupId:12,minTimeToSyncTimestampMs:d("LSSyncGroupsUtils").neverSyncTimestamp},{groupId:16},{groupId:26},{groupId:5},{groupId:28},e,c("qex")._("220")?{groupId:6,minTimeToSyncTimestampMs:d("LSSyncGroupsUtils").neverSyncTimestamp}:null,c("gkx")("2250")?{groupId:108}:null];function i(a,e){var f,g;return c("nativePromiseRegeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:i.next=2;return c("nativePromiseRegeneratorRuntime").awrap(d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.table("network_requests")).getKeyRange("")));case 2:f=i.sent;g=f.map(function(a){a=a.syncDatabaseId;return d("LSIntEnum").toNumber(a)});return i.abrupt("return",b("Promise").all(e.map(function(b){return c("nativePromiseRegeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:if(!(b!=null&&(!g.includes(b.groupId)||h.has(b.groupId)))){e.next=3;break}e.next=3;return c("nativePromiseRegeneratorRuntime").awrap(a.table("network_requests").put(babelHelpers["extends"]({},d("LSSyncGroupsUtils").defaultNetworkRequest,{syncDatabaseId:d("LSIntEnum").ofNumber(b.groupId)})));case 3:case"end":return e.stop()}},null,this)})));case 5:case"end":return i.stop()}},null,this)}function j(a,e){var f,g,i;return c("nativePromiseRegeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:i=function(b){var e,f;return c("nativePromiseRegeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:e=b.groupId,f=babelHelpers.objectWithoutPropertiesLoose(b,["groupId"]);if(!(!g.includes(e)||h.has(e))){i.next=4;break}i.next=4;return c("nativePromiseRegeneratorRuntime").awrap(a.table("sync_groups").put(babelHelpers["extends"]({},d("LSSyncGroupsUtils").defaultSyncGroup,f,{groupId:d("LSIntEnum").ofNumber(e)})));case 4:case"end":return i.stop()}},null,this)};j.next=3;return c("nativePromiseRegeneratorRuntime").awrap(d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.table("sync_groups"))));case 3:f=j.sent;g=f.map(function(a){a=a.groupId;return d("LSIntEnum").toNumber(a)});j.next=7;return c("nativePromiseRegeneratorRuntime").awrap(b("Promise").all(e.map(function(a){return a&&i(a)})));case 7:case"end":return j.stop()}},null,this)}function k(a){return a.table("_user_info").put({facebookUserId:d("I64").of_string(c("CurrentUser").getID()),id:d("LSIntEnum").ofNumber(1)})}function a(a,b){return c("nativePromiseRegeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return c("nativePromiseRegeneratorRuntime").awrap(k(a));case 2:d.next=4;return c("nativePromiseRegeneratorRuntime").awrap(i(a,b));case 4:d.next=6;return c("nativePromiseRegeneratorRuntime").awrap(j(a,b));case 6:case"end":return d.stop()}},null,this)}g.e2eeMetadataSyncGroup=e;g.defaultSyncGroups=f;g.seedDb=a}),98);
__d("MWLSSchemaEphemeral.bs",["LSDefaultSyncGroups","LSJSInMemoryStorage.bs","LSMetadata","LSTransaction.bs","Promise"],(function(a,b,c,d,e,f){"use strict";function a(a){return b("Promise").resolve(b("LSJSInMemoryStorage.bs").make(b("LSMetadata").metadata)).then(function(a){return b("LSTransaction.bs").run(a,function(a){return b("LSDefaultSyncGroups").seedDb(a,b("LSDefaultSyncGroups").defaultSyncGroups)},"readWrite").then(function(b){return a})})}f.createDB=a}),null);